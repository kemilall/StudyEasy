import React from 'react';
import {
  View,
  TouchableOpacity,
  Image,
} from 'react-native';
import { SvgXml } from 'react-native-svg';
import { useNavigation } from '@react-navigation/native';
import { Colors } from '../constants/colors';
import { useAuth } from '../contexts/AuthContext';

// SVG Logo strings
const brainLogoSvg = `<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="68.0478 80.168 363.9044 339.6639" width="363.904px" height="339.664px" preserveAspectRatio="none"><defs><linearGradient id="gradient_0" gradientUnits="userSpaceOnUse" x1="581.20789" y1="481.94135" x2="413.09717" y2="239.49858" gradientTransform="matrix(1, 0, 0, 1, -260.599213, -134.646912)"><stop offset="0" stop-color="#B0C1FF"/><stop offset="1" stop-color="#CFC5FF"/></linearGradient></defs><g transform="matrix(1, 0, 0, 1, 4.847660064697266, -0.5631560683249859)" id="object-0"><path fill="url(#gradient_0)" d="M 235.311 81.063 C 237.676 80.793 242.221 80.763 244.756 80.733 C 295.886 80.513 345.069 100.333 381.757 135.943 C 418.046 171.752 448.624 243.468 407.258 287.548 C 396.851 298.638 381.07 303.78 366.346 305.923 C 322.65 312.282 284.188 290.958 246.258 273.029 C 225.308 263.048 204.995 255.564 181.425 256.368 C 159.452 257.117 147.297 264.696 130.517 277.684 C 119.426 286.27 103.274 302.427 88.641 301.861 C 65.838 300.98 62.284 268.823 63.373 251.696 C 63.648 247.412 64.12 236.827 67.69 233.799 C 68.343 233.246 78.603 232.388 80.501 232.109 C 83.528 231.642 86.509 230.916 89.411 229.939 C 106.209 224.37 129.731 202.902 142.624 191.103 C 181.94 155.244 230.71 157.881 274.48 184.641 C 298.767 199.49 323.714 220.904 354.425 213.137 C 365.149 210.426 372.214 204.125 377.568 194.771 C 361.084 202.03 349.771 201.403 332.949 195.329 C 309.894 187.004 294.955 168.992 274.075 157.259 C 255.913 146.947 235.281 141.787 214.403 142.334 C 176.238 143.185 148.179 163.174 121.963 188.277 C 112.409 197.425 99.749 208.081 86.97 211.412 C 83.804 212.237 74.292 214.114 71.226 212.171 C 70.488 211.736 69.648 209.801 69.778 208.941 C 73.086 187.201 92.097 158.497 105.996 142.88 C 140.264 104.376 184.563 84.583 235.311 81.063 Z" style="stroke-width: 1;"/><path fill="#B5C2FE" d="M 182.875 280.559 C 220.846 276.161 249.755 300.45 284.248 309.81 C 290.845 311.6 302.498 311.315 309.494 311.374 C 300.981 321.295 284.729 325.611 272.697 332.078 C 246.162 346.34 228.641 368.591 212.973 393.644 C 209.338 399.192 206.431 405.258 202.982 410.921 C 195.127 423.818 184.289 422.47 174.193 413.337 C 176.137 403.166 182.51 393.721 180.389 381.653 C 179.871 378.707 178.247 373.688 176.002 371.771 C 162.087 360.223 141.951 364.154 127.452 352.948 C 112.235 341.187 118.903 320.364 129.367 307.864 C 143.315 291.201 161.358 282.656 182.875 280.559 Z" style="stroke-width: 1;"/></g></svg>`;

const textLogoSvg = `<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="85 200 330 85" width="330px" height="85px"><g transform="matrix(1, 0, 0, 1, 5.2286810874938965, 12.690704345703125)" id="object-0"><path fill="#393A3A" d="M 219.866 201.926 L 219.965 201.949 C 220.269 202.26 220.264 240.624 220.174 244.915 C 219.938 256.088 223.877 249.203 225.302 253.479 L 225.376 253.709 C 221.75 254.35 218.133 255.041 214.526 255.784 C 214.453 254.093 214.251 252.261 214.098 250.565 C 207.031 254.813 201.127 258.102 193.378 253.354 C 186.475 247.86 185.427 236.623 189.316 229.134 C 191.445 225.007 195.151 221.915 199.592 220.558 C 204.015 219.162 209.464 219.073 213.674 221.23 C 213.674 217.872 213.904 212.517 213.139 209.282 C 212.76 207.685 209.963 206.719 208.529 206.138 L 208.393 205.815 C 209.077 204.864 218.182 202.354 219.866 201.926 Z" style="stroke-width: 1;"/><path fill="white" d="M 203.458 222.832 C 206.432 222.973 209.034 223.447 211.3 225.581 C 214.323 228.429 213.7 233.378 213.697 237.175 L 213.686 248.52 C 210.205 250.196 208.27 250.855 204.46 250.968 C 195.788 250.769 193.335 242.546 194.012 235.338 C 194.561 229.499 196.787 223.419 203.458 222.832 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 298.301 205.99 C 298.516 205.911 298.371 205.951 298.747 205.938 C 299.162 206.875 300.027 216.326 299.684 216.972 C 298.348 216.696 295.752 211.426 293.879 210.347 C 290.202 208.229 280.705 208.185 276.853 209.069 L 276.814 229.078 C 280.618 229.078 285.854 229.382 289.393 228.157 C 291.68 227.366 291.644 225.402 292.471 223.366 C 293.057 223.213 292.768 223.215 293.369 223.387 C 293.579 223.628 293.84 224.079 293.793 224.37 C 293.53 225.994 294.061 237.344 293.464 238.031 C 292.103 237.907 292.11 234.401 290.645 233.271 C 287.34 230.722 280.698 231.321 276.807 231.325 C 276.926 237.274 276.607 243.527 276.991 249.476 C 277.033 250.13 277.526 251.039 278.13 251.311 C 281.956 253.031 289.022 252.282 292.889 251.352 C 296.124 250.473 298.028 248.25 299.942 245.641 C 300.609 244.732 301.144 243.725 302.003 243.041 C 302.728 242.973 302.413 242.893 302.997 243.195 C 303.08 243.905 301.261 253.271 301.01 254.943 L 265.08 254.955 L 264.584 253.148 C 266.242 252.988 269.671 253.097 269.678 250.565 C 269.715 237.034 270.188 223.021 269.434 209.542 C 269.352 208.071 264.656 208.035 264.115 207.521 C 264 206.725 263.937 207.079 264.197 206.406 C 265.369 206.173 270.132 206.264 271.5 206.265 L 288.485 206.28 C 290.808 206.282 295.935 206.409 298.042 206.038 L 298.301 205.99 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 320.232 219.753 C 336.929 217.805 330.904 235.067 332.045 245.385 C 332.305 247.736 331.393 252.108 335.106 252.038 C 336.062 252.02 337.561 251.567 338.324 251.822 C 338.536 252.364 338.505 252.46 338.527 253.033 C 336.371 255.156 330.445 256.881 328.034 254.59 C 326.677 253.299 326.425 252.45 326.102 250.743 C 320.861 254.809 313.702 258.397 308.05 252.733 C 305.281 248.768 306.12 244.453 309.839 241.459 C 314.363 237.816 320.277 236.694 325.859 235.777 C 325.936 227.457 326.065 221.946 315.468 223.288 C 314.251 226.032 314.31 227.862 313.656 230.731 C 311.859 230.444 309.948 230.225 308.136 229.987 C 308.255 228.392 308.415 226.969 308.616 225.38 C 311.316 222.347 316.285 220.362 320.232 219.753 Z" style="stroke-width: 1;"/><path fill="white" d="M 325.376 237.734 L 325.671 237.752 C 326.028 238.548 325.863 247.204 325.86 248.69 C 322.464 251.109 319.09 251.873 315.242 249.906 C 313.278 248.121 312.395 245.674 313.943 243.307 C 316.36 239.612 321.361 238.58 325.376 237.734 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 178.991 219.942 C 179.515 220.591 178.867 241.66 179.12 244.367 C 179.593 249.44 177.439 251.693 184.1 252.101 L 184.728 253.675 C 180.978 254.275 177.245 254.972 173.532 255.765 C 173.45 254.012 173.194 251.952 173.007 250.195 L 172.714 250.382 C 168.27 253.202 162.148 256.878 156.864 255.398 C 149.171 253.241 149.551 245.154 149.571 239.041 L 149.601 230.173 C 149.601 228.601 149.791 226.552 148.881 225.238 C 147.091 224.075 145.751 224.442 144.181 223.701 C 143.971 222.966 144.011 222.943 144.101 222.21 C 145.001 221.422 154.631 220.244 156.451 219.974 C 155.951 227.352 156.155 235.794 156.421 243.222 C 156.755 252.592 166.408 251.215 172.553 248.131 C 172.292 241.653 172.598 234.85 172.476 228.324 C 172.377 223.053 168.341 225.282 166.451 223.517 C 166.204 222.873 166.234 222.873 166.256 222.213 C 167.699 221.479 176.174 220.593 178.685 220.014 L 178.991 219.942 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 102.181 205.036 C 105.831 204.911 110.291 206.212 113.611 207.628 C 113.721 209.191 114.831 217.61 113.341 217.903 C 113.101 217.787 112.801 217.569 112.701 217.312 C 110.981 212.677 107.951 208.036 102.551 207.373 C 97.571 206.76 92.741 209.201 92.281 214.749 C 91.461 223.073 99.741 224.654 105.571 227.209 C 112.521 230.252 117.871 234.713 116.961 242.971 C 116.341 248.643 112.831 252.715 107.471 254.597 C 103.521 255.985 100.141 256.123 96.041 255.625 C 92.421 255.153 90.031 254.382 86.771 252.841 C 86.361 249.713 86.191 246.498 85.921 243.35 C 85.841 242.363 85.591 240.818 86.441 240.178 C 86.771 240.266 87.171 240.466 87.291 240.809 C 89.641 247.668 93.671 254.194 101.831 253.661 C 107.951 253.261 111.761 249.737 111.001 243.427 C 109.561 233.44 96.981 233.826 90.581 228.427 C 85.121 224.016 84.651 215.325 89.311 210.159 C 92.761 206.334 97.251 205.314 102.181 205.036 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 242.934 255.701 C 239.28 245.757 234.706 235.495 230.59 225.706 C 229.268 222.562 228.204 222.882 225.454 221.828 C 224.981 221.251 225.099 221.579 225.132 220.796 L 225.429 220.537 C 227.511 220.362 231.289 220.467 233.471 220.45 C 235.483 220.436 239.675 220.321 241.511 220.56 L 241.493 222.271 C 240.281 222.301 238.201 222.094 237.443 223.093 C 237.336 225.767 245.087 242.66 246.441 247.457 C 248.8 240.38 252.715 232.22 253.775 224.86 C 254.247 221.584 249.313 222.862 248.257 221.68 C 248.233 221.093 248.221 221.134 248.489 220.611 C 252.534 219.96 257.888 220.879 262.069 220.387 C 262.437 220.343 262.864 220.57 263.142 220.808 C 263.398 221.433 263.339 221.452 263.187 222.097 C 262.333 222.691 260.24 222.1 259.346 223.18 C 257.423 225.505 255.906 229.697 254.77 232.475 C 251.977 239.297 249.273 246.155 246.658 253.047 C 244.725 258.155 242.974 263.463 240.441 268.283 C 238.847 271.318 235.834 273.393 232.368 272.297 C 230.434 271.686 230.118 268.555 230.841 267.101 C 231.81 265.154 234.908 265.526 236.617 264.879 C 239.772 263.474 241.619 258.655 242.934 255.701 Z" style="stroke-width: 1;"/><path fill="#2D2C2D" d="M 241.493 222.271 L 240.082 222.038 L 240.444 221.533 C 240.348 221.154 240.342 221.132 240.292 220.73 L 241.511 220.56 L 241.493 222.271 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 387.157 247.25 C 388.936 242.517 390.773 237.801 392.523 233.026 C 393.118 231.404 395.232 225.12 394.328 223.432 C 393.707 222.27 390.939 222.346 389.912 222.207 C 389.392 222.136 389.31 221.819 389.141 221.432 C 389.244 220.793 389.097 221.008 389.439 220.574 C 391.078 220.374 402.1 220.372 403.55 220.642 C 403.771 221.242 403.751 220.946 403.624 221.563 C 402.71 222.558 400.111 222.326 399.083 224.155 C 397.996 226.092 397.224 228.045 396.38 230.092 L 392.499 239.601 L 386.23 255.137 C 384.556 259.281 382.897 263.568 380.668 267.444 C 378.831 270.637 375.619 273.519 371.676 272.475 C 369.55 271.912 368.783 270.138 369.62 268.135 C 370.586 265.822 374.057 265.781 376.046 264.918 C 380.142 263.327 381.938 259.427 383.662 255.696 C 380.855 248.339 377.89 241.043 374.77 233.813 C 373.492 230.85 372.166 227.676 370.772 224.779 C 369.607 222.359 368.027 222.578 366.007 222.034 C 365.591 221.435 365.761 221.399 365.81 220.463 C 368.468 220.458 380.315 220.128 382.096 220.598 C 383.026 223.332 379.828 221.787 378.551 222.719 C 378.213 223.397 378.228 224.205 378.45 224.916 C 380.794 232.424 385.222 239.631 387.157 247.25 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 130.981 211.636 C 131.341 212.015 130.881 219.504 130.841 220.47 L 142.861 220.468 C 142.331 221.747 142.341 222.305 142.231 223.682 C 141.151 223.978 132.591 223.869 130.911 223.867 C 130.951 228.493 130.951 233.118 130.921 237.744 C 130.921 243.409 129.671 251.666 137.781 251.31 C 140.281 251.201 141.411 250.94 143.561 249.622 L 144.671 250.959 L 143.311 252.001 C 137.011 256.377 126.161 258.954 124.441 248.078 C 124.031 245.518 124.281 242.185 124.281 239.532 L 124.301 223.76 C 122.461 223.839 120.561 223.87 118.711 223.922 C 120.061 222.23 129.331 212.797 130.981 211.636 Z" style="stroke-width: 1;"/><path fill="#393A3A" d="M 353.094 219.581 C 356.037 219.556 358.742 220.246 361.418 221.417 C 362.034 223.141 362.301 225.253 362.844 227.046 C 363.126 227.979 363.223 228.438 362.743 229.237 L 362.386 229.295 C 361.431 228.885 359.983 226.313 359.152 225.131 C 356.21 220.945 347.119 220.213 346.383 226.487 C 345.859 230.959 351.138 232.921 354.646 234.341 C 360.099 236.548 365.824 239.282 364.906 246.375 C 363.772 255.056 355.125 256.392 348.125 255.429 C 345.504 254.956 343.691 254.175 341.394 252.905 C 341.202 251.159 340.398 244.542 340.931 243.358 L 341.285 243.293 C 342.089 243.839 342.913 246.064 343.362 247.003 C 345.566 251.606 348.461 253.866 353.738 253.609 C 359.976 253.304 361.534 246.284 356.856 242.92 C 351.38 238.983 341.375 238.827 340.842 230.136 C 340.394 222.648 346.748 219.958 353.094 219.581 Z" style="stroke-width: 1;"/></g></svg>`;

export const Header: React.FC = () => {
  const navigation = useNavigation<any>();
  const { userProfile } = useAuth();

  return (
    <View style={{
      height: 60,
      paddingBottom: -5,
      backgroundColor: 'transparent',
      borderBottomWidth: 0,
      zIndex: 50,
    }}>
      <View style={{
        flex: 1,
        flexDirection: 'row',
        alignItems: 'center',
        justifyContent: 'space-between',
        paddingHorizontal: 20,
        maxWidth: 1280,
        alignSelf: 'center',
        width: '100%',
      }}>
        {/* Brand Logo */}
        <TouchableOpacity
          onPress={() => navigation.navigate('Home')}
          accessibilityLabel="StudyEasy - Accueil"
          style={{
            flexDirection: 'row',
            alignItems: 'center',
            gap: 8,
            marginTop: 5,
          }}
        >
          <SvgXml
            xml={brainLogoSvg}
            width={32}
            height={32}
          />
          <View style={{
            justifyContent: 'center',
            height: 35,
            marginTop: 5,
          }}>
            <SvgXml
              xml={textLogoSvg}
              width={110}
              height={30}
            />
          </View>
        </TouchableOpacity>

        {/* Right Side Actions */}
        <View style={{
          flexDirection: 'row',
          alignItems: 'center',
          gap: 16,
        }}>
          {/* Profile Menu */}
          <TouchableOpacity
            style={{
              width: 40,
              height: 40,
              borderRadius: 20,
              backgroundColor: Colors.surfaceAlt,
              alignItems: 'center',
              justifyContent: 'center',
            }}
            accessibilityLabel="Menu profil"
            onPress={() => navigation.navigate('Settings')}
          >
            {userProfile?.photoURL ? (
              <Image
                source={{ uri: userProfile.photoURL }}
                style={{
                  width: 40,
                  height: 40,
                  borderRadius: 20,
                }}
              />
            ) : (
              <Image
                source={require('../../assets/icon.png')}
                style={{
                  width: 40,
                  height: 40,
                  borderRadius: 20,
                }}
              />
            )}
          </TouchableOpacity>
        </View>
      </View>
    </View>
  );
};
